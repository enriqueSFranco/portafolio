---
import { type CollectionEntry, render } from "astro:content";

interface Props {
  project: CollectionEntry<"projects">;
}

const { project } = Astro.props;
const { data } = project;
const { slug, title, github, cover, summary, stack } = data;
const { Content } = await render(project);
---

<article
  aria-labelledby={`project-${slug}`}
  class="group relative flex flex-col h-full select-none overflow-hidden
         rounded-2xl p-5 border border-white/10 bg-zinc-900/40
         backdrop-blur-xl transition-all duration-300
         hover:border-white/20 hover:bg-zinc-900/60 hover:-translate-y-1"
>
  <!-- Spotlight gris azulado minimal -->
  <div
    class="pointer-events-none absolute inset-0 rounded-2xl opacity-0
           group-hover:opacity-100 transition duration-500
           bg-[radial-gradient(circle_at_top,rgba(200,200,255,0.06),transparent_75%)]
           z-0"
  >
  </div>

  <!-- GitHub -->
  <a
    aria-label="Abrir repositorio en GitHub"
    class="size-7 self-end opacity-60 hover:opacity-100 transition z-20"
    href={github}
    target="_blank"
    rel="noopener noreferrer"
  >
    <svg width="20" height="20">
      <use xlink:href="sprite.svg#github"></use>
    </svg>
  </a>

  <!-- Cover -->
  <div class="relative rounded-xl overflow-hidden z-10">
    {
      cover ? (
        <img
          transition:name={`img-${slug}`}
          src={cover}
          alt={`Imagen del proyecto ${title}`}
          class="w-full aspect-video object-cover rounded-xl border border-white/10"
        />
      ) : (
        <div
          class="w-full aspect-video bg-zinc-800/40 border border-white/10 
               rounded-xl grid place-content-center text-zinc-500 text-sm"
        >
          Sin imagen
        </div>
      )
    }
  </div>

  <!-- Content -->
  <div class="relative flex flex-col gap-3 mt-4 z-10 flex-1">
    <h3 class="text-lg font-semibold tracking-tight text-zinc-100">
      {title}
    </h3>

    <p class="text-sm text-zinc-400 leading-relaxed">
      {summary}
    </p>

    {
      stack?.length > 0 && (
        <ul class="flex flex-wrap gap-x-2 mt-1.5">
          {stack.map((tech) => (
            <li
              class="text-[11px] sm:text-[12px] px-2 py-1 rounded-md
                   bg-zinc-800/40 border border-white/10 text-zinc-300
                   backdrop-blur-sm"
            >
              {tech}
            </li>
          ))}
        </ul>
      )
    }
  </div>

  <!-- CTA -->
  <footer class="mt-4 z-10">
    <a
      href={`projects/${slug}`}
      class="text-sm font-medium text-zinc-300 hover:text-white transition"
    >
      Ver caso de estudio â†’
    </a>
  </footer>
</article>
